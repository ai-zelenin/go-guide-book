# Структура пакета

Пакет это строительная единица приложения, он в свою очередь состоит из типов(в основном структур)
/функций/переменных/константы(
глобальные), которые размещаются в файлах.  
Пакеты именуются как существительное в единственном числе без заглавных букв, допустимы сокращения, аббревиатуры и
просто созвучия. Например, httpcli или ioutil или rpcmidware [EffectiveGo](https://go.dev/blog/package-names).    
Файлы именуются в стиле snake_case.go [Issue](https://github.com/golang/go/issues/36060).

## Логическая структура

Логику пакета следует разбить на компоненты(типы с методами) с максимальной обособленной ответственностью.  
Каждый компонент должен иметь свой конструктор. Если в проекте используются [Fx](https://github.com/uber-go/fx)
конструкторы для него должны или быть объявлены в отдельном пакете или иметь префикс NewFx.  
Если поведение компонента предполагается конфигурировать снаружи, то нужно описать структуру конфигурации и или
передавать ее в конструктор/рабочий метод или использовать
паттерн [функциональных опций](https://github.com/uber-go/guide/blob/master/style.md#functional-options).    
Компоненты требующее действий не входящих в зону ответственности данного пакета должны требовать в своем конструкторе
реализацию данных функций от внешних зависимостей.

## Размещение по файлам

Размещать описания типов/функций/переменных в файлах стоит следующим образом.

- Полноценный тип, методы которого являются частью полезной нагрузки пакета всегда занимает отдельный файл. В нем
  описана структура данного типа потом его конструктор, потом методы привязанные к данному типу. Желательно, что бы
  последовательность описания методов имела следующую логику:

    1. Метод объекта имеющий зависимость от другого метода(вызывает другой метод этого же объекта)
       идет выше чем тот который вызывают.
    2. Если в названиях методов есть отсылки к процессам,  
       то они располагаются в порядке их логического вызова (Start, work, Stop)

##### Файл с правильно определенным типом

[Файл с правильно определенным типом](../../example/pack/worker.go)

- Типы, которые не несут полезной нагрузки, но повсеместно используются в пакете должны быть сгруппированы в файлы
  соответствующими названиями допустим конфигурации в config.go

- Типы, которые являются неотемлемой частью смысловой нагрузки другого типа и не могут быть переиспользованы должны
  размещаться в файле с родительским типом. Допустим DTO объекты должны быть описаны в том же файле, что и http.Handler
  который их использует.

- Функции не привязанные к типам, должны располагаться или в отдельных файлах или файле с названием util.go

- Переменные/константы пакетного уровня размещаются или в файле где они используются или, если они используются в многих
  файлах то файле с описанием структур конфигураций.

### Частые ошибки

##### Описание методов относящихся к другому типу

[Описание методов относящихся к другому типу](../../example/pack/item1.go)

##### Утилитарные функции/конфигурации в файлах с конкретным типом

[Утилитарные функции в файлах с конкретным типом](../../example/pack/item2.go)

Если какая-то часть логики вынесена в отдельную функцию, вероятно это сделано, что бы переиспользовать эту логику,
переиспользуемые компоненты не должны быть размещены(логически сгруппированы) с одним конкретным типом.




